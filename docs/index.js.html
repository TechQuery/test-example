<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>index.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="TestScript.html">TestScript</a><ul class='methods'><li data-type='method'><a href="TestScript.html#toString">toString</a></li></ul></li></ul><h3>Modules</h3><ul><li><a href="module-test-example.html">test-example</a></li></ul><h3>Externals</h3><ul><li><a href="external-EventEmitter.html">EventEmitter</a></li></ul><h3>Events</h3><ul><li><a href="TestScript.html#event:fileWrite">fileWrite</a></li><li><a href="TestScript.html#event:headerWrite">headerWrite</a></li><li><a href="TestScript.html#event:itemWrite">itemWrite</a></li></ul><h3>Namespaces</h3><ul><li><a href="module-test-example-config.html">config</a></li></ul><h3><a href="global.html">Global</a></h3>
</nav>

<div id="main">

    <h1 class="page-title">index.js</h1>

    <section>
        <article>
            <pre class="prettyprint source linenums"><code>'use strict';
/**
 * Test Example - A JSDoc plugin for generating Test scripts by parsing @example
 *
 * @module    {object} test-example
 *
 * @version   0.4.0
 *
 * @see       {@link https://techquery.github.io/test-example|Offical Web site}
 *
 * @copyright TechQuery &lt;shiy007@qq.com> 2017
 */
const Path = require('path'), FS = require('fs-extra');

/**
 * **Config namespace** of this plugin
 *
 * @namespace config
 *
 * @property {string}  [config.sourcePath="source/"] - Path of
 *                                                     the **Source directory**
 * @property {string}  [config.testPath="test/"]     - Path of
 *                                                     the **Test directory**
 * @property {boolean} [config.overWrite=true]       - Overwrite existed
 *                                                     test scripts or not
 * @property {string}  [config.hookModule]           - Path of Node.JS Module
 *                                                     contained **Hook method**
 *
 * @example  // Merge those options below to your JSDoc `config.json`
 *     {
 *         "plugins":         ["node_modules/test-example"],
 *         "test-example":    {
 *             "sourcePath":    "path/to/source/directory",
 *             "testPath":      "path/to/test/directory",
 *             "overWrite":     false,
 *             "hookModule":    "path/to/plugin/hook"
 *         }
 *     }
 */
const config = Object.assign(
          {
              sourcePath:    'source/',
              testPath:      'test/',
              overWrite:     true
          },
          require('jsdoc/env').conf['test-example']
      ),
      TestScript = require('./TestFile');

const hook = config.hookModule &amp;&amp; require(
          Path.join(process.cwd(), config.hookModule)
      );

var file;


exports.handlers = {
    beforeParse:     function (event) {

        file = new TestScript(event.filename, config.sourcePath, config.testPath);

        for (var handler in hook)  file.on(handler,  hook[ handler ]);

        if (! /\s*define\(/.test( event.source ))
            file.addHeader(
                `var ${file.ID} = require('${file.sourceURI}')`
            );
    },
    newDoclet:       function(event) {

        file.addUnit( event.doclet );
    },
    fileComplete:    function (event) {

        if ((! file[0])  ||  (
            FS.existsSync( file.testURI )  &amp;&amp;  (! config.overWrite)
        ))
            return;

        FS.outputFileSync(file.testURI,  file + '');

        console.log(`\n\t[Test script] ${file.testURI}\n`);
    }
};
</code></pre>
        </article>
    </section>

</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
